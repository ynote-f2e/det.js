<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title></title>
</head>
<body>
<svg id="diagram" width="800" height="600"></svg>
<p>
    <button onclick="undo()">Undo</button>
    <button onclick="redo()">Redo</button>
    <button onclick="removeSeletion()">删除选中的节点</button>
</p>
</body>
<script src="../det/src/det.js"></script>
<script src="../det/src/toolkit.js"></script>
<script src="../det/src/events.js"></script>
<script src="../det/src/model.js"></script>
<script src="../det/src/stack.js"></script>
<script src="../det/src/ctrl/base.js"></script>
<script src="../det/src/ctrl/graph.js"></script>
<script src="../det/src/ctrl/diagram.js"></script>
<script src="../det/src/ctrl/link.js"></script>
<script src="../det/src/feature/base.js"></script>
<script src="../det/src/feature/drag.js"></script>
<script src="../det-mind-map/src/plugin.js"></script>
<script src="../det-mind-map/src/cmd/edit.js"></script>
<script src="../det-mind-map/src/cmd/remove.js"></script>
<script src="../det-mind-map/src/ctrl/diagram.js"></script>
<script src="../det-mind-map/src/ctrl/node.js"></script>
<script src="../det-mind-map/src/model/diagram.js"></script>
<script src="../det-mind-map/src/model/node.js"></script>
<script src="../det-mind-map/src/feature/layout.js"></script>
<script src="../det-mind-map/src/feature/select.js"></script>
<script src="../bower_components/Snap.svg/dist/snap.svg.js"></script>
<script>
    var toolkit = det.create(), diagram, diagramCtrl;
    toolkit.plugin(detMindMap);
    diagram = new detMindMap.MindDiagram({
        title : '我的图',
        root : {
            text : '中心主题',
            rectAttr : {
                fill : '#fff',
                stroke : "#666",
                strokeWidth : '2',
            },
            textAttr : {
                fill : '#000',
                'font-size' : 40
            },
            nodes : [{
                text : '子主题1',
                nodes : [{
                    text : '子主题1-1'
                }, {
                    text : '子主题1-2'
                }, {
                    text : '子主题1-3'
                }, {
                    text : '子主题1-4'
                }, {
                    text : '子主题1-5'
                }, {
                    text : '子主题1-6'
                }]
            }, {
                text : '子主题2'
            }, {
                text : '子主题3'
            }, {
                text : '子主题4',
                nodes : [{
                    text : '子主题4-1'
                }, {
                    text : '子主题4-2'
                }, {
                    text : '子主题4-3'
                }]
            }, {
                text : '子主题5',
                nodes : [{
                    text : '子主题5-1'
                }, {
                    text : '子主题5-2'
                }, {
                    text : '子主题5-3'
                }]
            }, {
                text : '子主题6',
                nodes : [{
                    text : '子主题6-1'
                }, {
                    text : '子主题6-2'
                }, {
                    text : '子主题6-3'
                }]
            }]
        }
    });
    diagramCtrl = toolkit.render(document.getElementById('diagram'), diagram);

    function undo() {
        diagramCtrl.getCommandStack().undo();
    }

    function redo() {
        diagramCtrl.getCommandStack().redo();
    }

    function removeSeletion() {
        var selection = diagramCtrl.getSelection(),
            rootCtrl = diagramCtrl.getRootCtrl();
        if (selection.length == 0) {
            return;
        }
        selection = selection[0];
        if (selection === rootCtrl) {
            return;
        }
        selection.execute(
            new detMindMap.RemoveCommand(
                selection.getParent().getModel(),
                selection.getModel()))
    }

</script>
</html>
