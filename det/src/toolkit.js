det.Toolkit = (function (det) {    'use strict';    det.create = function () {        return new det.Toolkit();    };    return det.derive(function () {        this.loaded = false;        this.plugins = [];        this.ctrlFactory = new CtrlFactory(this);        this.filterFactory = new FilterFactory(this);    }, {        render : function render(el, model) {            var diagramCtrl;            if (!this.loaded) {                this.plugins.forEach(function (plugin) {                    plugin(this);                }.bind(this));            }            diagramCtrl = this.ctrlFactory.create(model);            diagramCtrl.render(new Snap(el));            return diagramCtrl;        },        plugin : function registerPlugin(plugin) {            if (this.plugins.indexOf(plugin) !== -1) {                return this;            }            this.plugins.push(plugin);        },        getCtrlFactory : function () {            return this.ctrlFactory;        },        getFilterFactory : function () {            return this.filterFactory;        }    });}(det));